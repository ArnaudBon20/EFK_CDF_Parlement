<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDF/EFK - Statistiques</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="header-main">
                <h1><a href="home.html" style="color: inherit; text-decoration: none;">ğŸ›ï¸ Le CDF aux Chambres fÃ©dÃ©rales</a></h1>
                <nav>
                    <a href="home.html">Accueil</a>
                    <a href="index.html">Objets</a>
                    <a href="debates.html">DÃ©bats</a>
                    <a href="stats.html" class="active">Statistiques</a>
                </nav>
            </div>
            <div class="lang-switcher">
                <a href="stats.html" class="active">FR</a>
                <span>|</span>
                <a href="stats_de.html">DE</a>
                <span>|</span>
                <a href="stats_it.html">IT</a>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="global-summary">
            <h2>ğŸ“Š Vue d'ensemble</h2>
            <div class="summary-cards">
                <div class="summary-card">
                    <span class="summary-number" id="globalObjectsCount">-</span>
                    <span class="summary-label">Objets parlementaires</span>
                    <div class="mention-breakdown" id="mentionBreakdown">
                        <a href="index.html?filter_mention=elu" class="mention-stat" title="L'Ã©lu cite le CDF">
                            <span class="mention-icon">ğŸ‘¤</span>
                            <span class="mention-pct" id="pctElu">-</span>
                        </a>
                        <a href="index.html?filter_mention=cf" class="mention-stat" title="Le Conseil fÃ©dÃ©ral cite le CDF">
                            <span class="mention-icon">ğŸ›ï¸</span>
                            <span class="mention-pct" id="pctCF">-</span>
                        </a>
                        <a href="index.html?filter_mention=both" class="mention-stat" title="Les deux citent le CDF">
                            <span class="mention-icon">ğŸ‘¤ğŸ›ï¸</span>
                            <span class="mention-pct" id="pctBoth">-</span>
                        </a>
                    </div>
                </div>
                <div class="summary-card">
                    <span class="summary-number" id="globalDebatesCount">-</span>
                    <span class="summary-label">DÃ©bats</span>
                </div>
                <div class="summary-card">
                    <span class="summary-period" id="globalPeriod">2015 - 2026</span>
                    <span class="summary-label">PÃ©riode analysÃ©e</span>
                </div>
            </div>
        </section>

        <section class="stats-section">
            <h2>ğŸ“Š Statistiques des interventions</h2>
            
            <div class="stats-filters">
                <div class="filter-dropdown" id="objectLegislatureDropdown">
                    <button class="filter-btn" type="button">LÃ©gislature <span class="filter-count"></span></button>
                    <div class="filter-menu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Toutes</label>
                        <label><input type="checkbox" value="52"> 52Ã¨me (dÃ¨s dÃ©c. 2023)</label>
                        <label><input type="checkbox" value="51"> 51Ã¨me (dÃ©c. 2019 - sept. 2023)</label>
                        <label><input type="checkbox" value="50"> 50Ã¨me (dÃ©c. 2015 - sept. 2019)</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="objectYearDropdown">
                    <button class="filter-btn" type="button">AnnÃ©e <span class="filter-count"></span></button>
                    <div class="filter-menu" id="objectYearMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Toutes</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="objectCouncilDropdown">
                    <button class="filter-btn" type="button">Conseil <span class="filter-count"></span></button>
                    <div class="filter-menu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                        <label><input type="checkbox" value="N"> Conseil national</label>
                        <label><input type="checkbox" value="S"> Conseil des Ã‰tats</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="objectPartyDropdown">
                    <button class="filter-btn" type="button">Parti <span class="filter-count"></span></button>
                    <div class="filter-menu" id="objectPartyMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="objectDeptDropdown">
                    <button class="filter-btn" type="button">AutoritÃ© <span class="filter-count"></span></button>
                    <div class="filter-menu" id="objectDeptMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="objectTagsDropdown">
                    <button class="filter-btn" type="button">ThÃ©matiques <span class="filter-count"></span></button>
                    <div class="filter-menu" id="objectTagsMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Toutes</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="objectMentionDropdown">
                    <button class="filter-btn" type="button">Qui cite <span class="filter-count"></span></button>
                    <div class="filter-menu" id="objectMentionMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                        <label><input type="checkbox" value="elu"> ğŸ‘¤ Ã‰lu</label>
                        <label><input type="checkbox" value="cf"> ğŸ›ï¸ Conseil fÃ©dÃ©ral</label>
                        <label><input type="checkbox" value="both"> ğŸ‘¤ğŸ›ï¸ Les deux</label>
                    </div>
                </div>
                <button class="filter-reset" id="resetObjectFilters" title="RÃ©initialiser">â†»</button>
            </div>
            
            <div class="stats-row">
                <div class="stat-card">
                    <h3>Interventions par parti</h3>
                    <div class="chart-container">
                        <canvas id="partyChart"></canvas>
                        <button class="chart-screenshot-btn" onclick="downloadChart('partyChart', 'objets-par-parti')" title="TÃ©lÃ©charger l'image">ğŸ“·</button>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3>Interventions par type</h3>
                    <div class="chart-container">
                        <canvas id="typeChart"></canvas>
                        <button class="chart-screenshot-btn" onclick="downloadChart('typeChart', 'objets-par-type')" title="TÃ©lÃ©charger l'image">ğŸ“·</button>
                    </div>
                </div>
            </div>
            
            <div class="stats-row">
                <div class="stat-card">
                    <h3>ğŸ“ˆ Ã‰volution par annÃ©e</h3>
                    <div class="chart-container-wide">
                        <canvas id="yearChart"></canvas>
                        <button class="chart-screenshot-btn" onclick="downloadChart('yearChart', 'objets-par-annee')" title="TÃ©lÃ©charger l'image">ğŸ“·</button>
                    </div>
                    <div id="sessionDetail" class="session-detail" style="display: none;">
                        <h4 id="sessionDetailTitle"></h4>
                        <div id="sessionDetailContent"></div>
                    </div>
                </div>
                
                <div class="stat-card top-card">
                    <h3>ğŸ—£ï¸ Parlementaires qui citent le plus le CDF</h3>
                    <div id="topAuthors" class="top-authors-list">
                        <p>Chargement...</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="stats-section">
            <h2>ğŸ’¬ Statistiques des dÃ©bats</h2>
            
            <div class="stats-filters">
                <div class="filter-dropdown" id="debateLegislatureDropdown">
                    <button class="filter-btn" type="button">LÃ©gislature <span class="filter-count"></span></button>
                    <div class="filter-menu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Toutes</label>
                        <label><input type="checkbox" value="52"> 52Ã¨me (dÃ¨s dÃ©c. 2023)</label>
                        <label><input type="checkbox" value="51"> 51Ã¨me (dÃ©c. 2019 - sept. 2023)</label>
                        <label><input type="checkbox" value="50"> 50Ã¨me (dÃ©c. 2015 - sept. 2019)</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="debateYearDropdown">
                    <button class="filter-btn" type="button">AnnÃ©e <span class="filter-count"></span></button>
                    <div class="filter-menu" id="debateYearMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Toutes</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="debateSessionDropdown">
                    <button class="filter-btn" type="button">Session <span class="filter-count"></span></button>
                    <div class="filter-menu" id="debateSessionMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Toutes</label>
                        <label><input type="checkbox" value="Printemps"> Printemps</label>
                        <label><input type="checkbox" value="Ã‰tÃ©"> Ã‰tÃ©</label>
                        <label><input type="checkbox" value="Automne"> Automne</label>
                        <label><input type="checkbox" value="Hiver"> Hiver</label>
                        <label><input type="checkbox" value="SpÃ©ciale"> SpÃ©ciale</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="debateCouncilDropdown">
                    <button class="filter-btn" type="button">Conseil <span class="filter-count"></span></button>
                    <div class="filter-menu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                        <label><input type="checkbox" value="N"> Conseil national</label>
                        <label><input type="checkbox" value="S"> Conseil des Ã‰tats</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="debatePartyDropdown">
                    <button class="filter-btn" type="button">Parti <span class="filter-count"></span></button>
                    <div class="filter-menu" id="debatePartyMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                    </div>
                </div>
                <div class="filter-dropdown" id="debateDeptDropdown">
                    <button class="filter-btn" type="button">AutoritÃ© <span class="filter-count"></span></button>
                    <div class="filter-menu" id="debateDeptMenu">
                        <label class="select-all"><input type="checkbox" data-select-all checked> Tous</label>
                    </div>
                </div>
                <button class="filter-reset" id="resetDebateFilters" title="RÃ©initialiser">â†»</button>
            </div>
            
            <div class="stats-row">
                <div class="stat-card">
                    <h3>Interventions par acteur</h3>
                    <div class="chart-container">
                        <canvas id="debatePartyChart"></canvas>
                        <button class="chart-screenshot-btn" onclick="downloadChart('debatePartyChart', 'debats-par-acteur')" title="TÃ©lÃ©charger l'image">ğŸ“·</button>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3>Interventions par conseil</h3>
                    <div class="chart-container">
                        <canvas id="debateCouncilChart"></canvas>
                        <button class="chart-screenshot-btn" onclick="downloadChart('debateCouncilChart', 'debats-par-conseil')" title="TÃ©lÃ©charger l'image">ğŸ“·</button>
                    </div>
                </div>
            </div>
            
            <div class="stats-row">
                <div class="stat-card top-card">
                    <h3>ğŸ“¢ Orateurs</h3>
                    <div id="topSpeakers" class="top-authors-list">
                        <p>Chargement...</p>
                    </div>
                </div>
                
                <div class="stat-card top-card">
                    <h3>ğŸ“¢ Orateurs (hors CF)</h3>
                    <div id="topSpeakersNoCF" class="top-authors-list">
                        <p>Chargement...</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>DonnÃ©es: <a href="https://ws-old.parlament.ch/" target="_blank">API du Parlement suisse</a> Â· 
               <a href="https://github.com/EFK-CDF-SFAO/Parlement" target="_blank">Code source</a> Â· <a href="https://github.com/EFK-CDF-SFAO/Parlement?tab=readme-ov-file#-ios-widget" target="_blank">ğŸ“± Widget iOS</a></p>
            <p class="feedback-box"><a href="mailto:arnaud.bonvin@efk.admin.ch">Feedback ?</a></p>
        </div>
    </footer>

    <button id="scrollTopBtn" class="scroll-top-btn" title="Retour en haut">â†‘</button>
    <script src="stats.js"></script>
    <script>
        const scrollBtn = document.getElementById('scrollTopBtn');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollBtn.classList.add('visible');
            } else {
                scrollBtn.classList.remove('visible');
            }
        });
        scrollBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>
